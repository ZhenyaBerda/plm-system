(this["webpackJsonpplm-client"]=this["webpackJsonpplm-client"]||[]).push([[0],{126:function(e,t,n){},181:function(e,t,n){},216:function(e,t,n){},290:function(e,t,n){},291:function(e,t,n){},292:function(e,t,n){"use strict";n.r(t);var c=n(0),a=n(29),r=n.n(a),i=n(47),s=n(37),o=n(53),u=n(6),l=function(e){var t=e.children;return Object(u.jsx)(o.a,{children:t})},d=n(33),j=n(10),b=n(201),p="https://graph.microsoft.com",f="/login",O=f,h="/",m="/groups",x="/groups/board",v=function(e){var t=e.children,n=e.component,c=e.render,a=Object(b.a)(e,["children","component","render"]),r=Object(s.b)();return Object(u.jsx)(d.b,Object(j.a)(Object(j.a)({},a),{},{render:function(e){return r?n?Object(u.jsx)(n,Object(j.a)({},e)):c?c(e):t:Object(u.jsx)(d.a,{to:{pathname:f,state:{from:e.location}}})}}))},g=n(16),y=n.n(g),k=n(23),w=n(25),T=n(301),I=n(39),N=n(27),S={auth:{clientId:"a5a76f0a-a6a5-4a0c-b564-6bc0e39716a4",authority:"https://login.microsoftonline.com/common",redirectUri:"http://localhost:3000"},cache:{cacheLocation:"localStorage",storeAuthStateInCookie:!1},system:{loggerOptions:{loggerCallback:function(e,t,n){if(!n)switch(e){case N.e.Error:return void console.error(t);case N.e.Info:return void console.info(t);case N.e.Verbose:return void console.debug(t);case N.e.Warning:return void console.warn(t)}}}}},E={scopes:["User.Read"]},C={graphMeEndpoint:"".concat(p,"/v1.0/me")},A=n(183),B=n(133),D=n(184),L=n(197),_=n(198),U=function(e){e};Error;function R(e){return z.apply(this,arguments)}function z(){return(z=Object(k.a)(y.a.mark((function e(t){var n,c,a;return y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=new Headers,c="Bearer ".concat(t),n.append("Authorization",c),a={method:"GET",headers:n},e.next=6,fetch(C.graphMeEndpoint,a).then((function(e){return e.json()})).catch((function(e){return console.log(e)}));case 6:return e.abrupt("return",e.sent);case 7:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var q;n(216);!function(e){e[e.LOG_IN=0]="LOG_IN",e[e.LOG_OUT=1]="LOG_OUT",e[e.SET_AUTHENTICATION_ERROR=2]="SET_AUTHENTICATION_ERROR"}(q||(q={}));var G=function(e){return{type:q.LOG_IN,user:e}},M=function(){return{type:q.LOG_OUT}},P=function(e){return{type:q.SET_AUTHENTICATION_ERROR,error:e}},V={isAuthenticated:null,user:{id:"",firstName:"",lastName:"",email:""}};var H,J,F,X=T.a.Title,Y=T.a.Text,W=function(e){var t=Object(s.c)(),n=t.instance,a=t.accounts,r=Object(c.useState)(!1),o=Object(w.a)(r,2),l=(o[0],o[1]),d=Object(i.c)(),b=e.history,p=e.location,f=function(){var e=Object(k.a)(y.a.mark((function e(){var t,c,r,i,s,o,u;return y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=!1,e.next=3,n.loginPopup(E).catch((function(e){t=!0}));case 3:if(!t){e.next=7;break}return l(!0),d(P("error")),e.abrupt("return");case 7:return e.next=9,n.acquireTokenSilent(Object(j.a)(Object(j.a)({},E),{},{account:a[0]})).then((function(e){localStorage.setItem("accessToken",e.accessToken)})).catch((function(e){return t=!0}));case 9:return e.sent,e.next=12,R(localStorage.getItem("accessToken"));case 12:if(c=e.sent){e.next=17;break}return d(P("error")),l(!0),e.abrupt("return");case 17:r={id:c.id,firstName:c.givenName,lastName:c.surname,email:c.mail},d(G(r)),U(!0),i=p.state,s=i&&i.from?i:{from:{pathname:"/"}},o=s.from,u=null===i||void 0===i?void 0:i.from.state,b.replace(o,u);case 24:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return Object(u.jsxs)("div",{className:"login-page",children:[Object(u.jsx)("div",{className:"login",children:Object(u.jsxs)("div",{className:"loginbox",children:[Object(u.jsxs)("div",{className:"title",children:[Object(u.jsx)(Y,{type:"secondary",children:"Welcome back!"}),Object(u.jsx)(X,{style:{marginTop:"10px",color:"#001529"},children:"Login your account"})]}),Object(u.jsx)(I.a,{style:{width:"100%"},onClick:f,type:"primary",htmlType:"submit",className:"login-form-button",children:"Log in with Azure AD"})]})}),Object(u.jsx)("div",{className:"login-info",children:"d"})]})},K=n(296),Q=n(305),Z=n(294),$=n(92),ee=function(e){return e.isAuthenticated},te=function(e){return e.authenticationError},ne=function(e){return e.user},ce=(n(126),Z.a.Header),ae=Z.a.Content,re=Z.a.Sider,ie=Z.a.Footer,se=function(e){var t=window.location.pathname===h?["1"]:["2"],n=Object(i.c)(),a=Object(i.d)(ne),r=Object(d.g)(),s=Object(c.useCallback)((function(){n(M()),U(!1)}),[n,r]);return Object(u.jsxs)(Z.a,{style:{minHeight:"100vh"},children:[Object(u.jsxs)(re,{width:200,children:[Object(u.jsx)("div",{className:"logo",children:"PLM"}),Object(u.jsxs)($.a,{selectedKeys:t,theme:"dark",mode:"inline",children:[Object(u.jsx)($.a.Item,{children:Object(u.jsx)(o.b,{to:h,children:"\u041f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u0438"})},"1"),Object(u.jsx)($.a.Item,{children:Object(u.jsx)(o.b,{to:m,children:"\u041f\u0440\u043e\u0435\u043a\u0442\u044b"})},"2")]})]}),Object(u.jsxs)(Z.a,{children:[Object(u.jsx)(ce,{style:{padding:0,background:"#fff"},children:Object(u.jsxs)("div",{style:{padding:"0 50px",display:"flex",alignItems:"center",justifyContent:"flex-end"},children:[Object(u.jsx)("div",{style:{marginRight:"30px"},children:a.firstName+" "+a.lastName}),Object(u.jsx)(o.b,{to:O,onClick:s,children:"\u0412\u044b\u0439\u0442\u0438"})]})}),Object(u.jsx)(ae,{style:{margin:"0 16px"},children:e.children}),Object(u.jsx)(ie,{style:{textAlign:"center"},children:"PLM System @ 2021 Created by Evgeniya Berdnikova"})]})]})},oe=function(){var e=Object(k.a)(y.a.mark((function e(t){var n;return y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("".concat(p,"/v1.0/users"),{method:"GET",headers:{Authorization:"Bearer ".concat(t),Accept:"application/json"}});case 2:return n=e.sent,e.abrupt("return",n.json());case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),ue=function(){var e=Object(k.a)(y.a.mark((function e(t,n){var c;return y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("".concat(p,"/v1.0/users/").concat(n),{method:"GET",headers:{Authorization:"Bearer ".concat(t),Accept:"application/json"}});case 2:return c=e.sent,e.abrupt("return",c.json());case 4:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),le=function(){var e=Object(k.a)(y.a.mark((function e(t){var n;return y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("".concat(p,"/v1.0/groups"),{method:"GET",headers:{Authorization:"Bearer ".concat(t),Accept:"application/json"}});case 2:return n=e.sent,e.abrupt("return",n.json());case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),de=function(){var e=Object(k.a)(y.a.mark((function e(t,n){var c;return y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("".concat(p,"/v1.0/groups"),{method:"POST",headers:{Authorization:"Bearer ".concat(t),"Content-Type":"application/json",Accept:"application/json"},body:JSON.stringify(n)});case 2:return c=e.sent,e.abrupt("return",c.json());case 4:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),je=function(){var e=Object(k.a)(y.a.mark((function e(t,n){var c;return y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("".concat(p,"/v1.0/groups/").concat(n,"/drive/root/children"),{method:"GET",headers:{Authorization:"Bearer ".concat(t),Accept:"application/json"}});case 2:return c=e.sent,e.abrupt("return",c.json());case 4:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),be=function(){var e=Object(k.a)(y.a.mark((function e(t,n,c){var a;return y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("".concat(p,"/beta/groups/").concat(n,"/drive/items/").concat(c,"/createLink"),{method:"POST",headers:{Authorization:"Bearer ".concat(t),"Content-Type":"application/x-www-form-urlencoded"}});case 2:return a=e.sent,e.abrupt("return",a.json());case 4:case"end":return e.stop()}}),e)})));return function(t,n,c){return e.apply(this,arguments)}}(),pe=function(){var e=Object(k.a)(y.a.mark((function e(t,n,c){var a;return y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("".concat(p,"/beta/groups/").concat(n,"/drive/items/").concat(c),{method:"DELETE",headers:{Authorization:"Bearer ".concat(t)}});case 2:return a=e.sent,e.abrupt("return",a.json());case 4:case"end":return e.stop()}}),e)})));return function(t,n,c){return e.apply(this,arguments)}}(),fe=function(){var e=Object(k.a)(y.a.mark((function e(t,n,c,a){var r;return y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("".concat(p,"/v1.0/groups/").concat(n,"/drive/root/").concat(c,"/").concat(a),{method:"PUT",headers:{Authorization:"Bearer ".concat(t),Accept:"application/json"}});case 2:return r=e.sent,e.abrupt("return",r.json());case 4:case"end":return e.stop()}}),e)})));return function(t,n,c,a){return e.apply(this,arguments)}}(),Oe=function(){var e=Object(k.a)(y.a.mark((function e(t,n){var c;return y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("".concat(p,"/v1.0/groups/").concat(n,"/planner/plans"),{method:"GET",headers:{Authorization:"Bearer ".concat(t)}});case 2:return c=e.sent,e.abrupt("return",c.json());case 4:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),he=function(){var e=Object(k.a)(y.a.mark((function e(t,n){var c;return y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("".concat(p,"/v1.0/planner/plans/").concat(n,"/tasks"),{method:"GET",headers:{Authorization:"Bearer ".concat(t)}});case 2:return c=e.sent,e.abrupt("return",c.json());case 4:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),me=function(){var e=Object(k.a)(y.a.mark((function e(t,n){var c;return y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("".concat(p,"/v1.0/groups/").concat(n,"/members"),{method:"GET",headers:{Authorization:"Bearer ".concat(t)}});case 2:return c=e.sent,e.abrupt("return",c.json());case 4:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),xe=function(){var e=Object(k.a)(y.a.mark((function e(t,n){var c;return y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("".concat(p,"/beta/planner/tasks"),{method:"POST",headers:{Authorization:"Bearer ".concat(t),"Content-type":"application/json"},body:JSON.stringify(n)});case 2:return c=e.sent,e.abrupt("return",c.json());case 4:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),ve=function(){var e=Object(k.a)(y.a.mark((function e(t,n,c,a){var r;return y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("".concat(p,"/beta/planner/tasks/").concat(n),{method:"PATCH",headers:{Authorization:"Bearer ".concat(t),"if-Match":a,"Content-type":"application/json"},body:JSON.stringify(c)});case 2:return r=e.sent,e.abrupt("return",r.json());case 4:case"end":return e.stop()}}),e)})));return function(t,n,c,a){return e.apply(this,arguments)}}(),ge=n(306),ye=n(307),ke=n(302),we=n(300),Te=n(303),Ie=n(80),Ne=function(e){var t,n,a=e.isVisible,r=e.onClose,i=e.onCreate,s=e.isLoading,o=Object(c.useState)({id:"",displayName:"",description:null,mailEnabled:!1,mailNickname:null,securityEnabled:!0}),l=Object(w.a)(o,2),d=l[0],b=l[1];return Object(u.jsx)(ke.a,{title:"\u041d\u043e\u0432\u0430\u044f \u0433\u0440\u0443\u043f\u043f\u0430",visible:a,onCancel:r,confirmLoading:s,onOk:function(){return i(d)},okText:"\u0421\u043e\u0437\u0434\u0430\u0442\u044c",cancelText:"\u041e\u0442\u043c\u0435\u043d\u0430",children:Object(u.jsxs)(we.a,{layout:"vertical",children:[Object(u.jsx)(we.a.Item,{name:"nickname",label:"\u041f\u0441\u0435\u0432\u0434\u043e\u043d\u0438\u043c \u0433\u0440\u0443\u043f\u043f\u044b",rules:[{required:!0,message:"\u0412\u0432\u0435\u0434\u0438\u0442\u0435 \u043f\u0441\u0435\u0432\u0434\u043e\u043d\u0438\u043c \u0433\u0440\u0443\u043f\u043f\u044b"}],children:Object(u.jsx)(Te.a,{value:null!==(t=d.mailNickname)&&void 0!==t?t:"",onChange:function(e){b(Object(j.a)(Object(j.a)({},d),{},{mailNickname:e.target.value}))}})}),Object(u.jsx)(we.a.Item,{name:"title",label:"\u041e\u0442\u043e\u0431\u0440\u0430\u0436\u0430\u0435\u043c\u043e\u0435 \u0438\u043c\u044f",rules:[{required:!0,message:"\u0412\u0432\u0435\u0434\u0438\u0442\u0435 \u043e\u0442\u043e\u0431\u0440\u0430\u0436\u0430\u0435\u043c\u043e\u0435 \u0438\u043c\u044f"}],children:Object(u.jsx)(Te.a,{value:d.displayName,onChange:function(e){b(Object(j.a)(Object(j.a)({},d),{},{displayName:e.target.value}))}})}),Object(u.jsx)(we.a.Item,{name:"description",label:"\u041e\u043f\u0438\u0441\u0430\u043d\u0438\u0435",children:Object(u.jsx)(Ie.a,{value:null!==(n=d.description)&&void 0!==n?n:"",onChange:function(e){e.target.value?b(Object(j.a)(Object(j.a)({},d),{},{description:e.target.value})):b(Object(j.a)(Object(j.a)({},d),{},{description:null}))}})})]})})},Se=function(){var e=Object(c.useState)([]),t=Object(w.a)(e,2),n=t[0],a=t[1],r=Object(c.useState)(!1),i=Object(w.a)(r,2),l=i[0],d=i[1],b=Object(c.useState)(!1),p=Object(w.a)(b,2),f=p[0],O=p[1],h=Object(s.c)(),v=h.instance,g=h.accounts;Object(c.useEffect)((function(){v.acquireTokenSilent(Object(j.a)(Object(j.a)({},E),{},{account:g[0]})).then((function(e){le(e.accessToken).then((function(e){a(e.value.map((function(e){return Object(j.a)(Object(j.a)({},e),{},{key:e.id})})))}))})).catch((function(e){return console.log(e)}))}),[]);var T=function(){var e=Object(k.a)(y.a.mark((function e(t){return y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:O(!0),v.acquireTokenSilent(Object(j.a)(Object(j.a)({},E),{},{account:g[0]})).then(function(){var e=Object(k.a)(y.a.mark((function e(n){return y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,de(n.accessToken,t);case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()).catch((function(e){return console.log(e)})),O(!1),d(!1);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),N=Object(c.useCallback)((function(){d(!1)}),[d]);return Object(u.jsxs)(se,{children:[Object(u.jsx)(Ne,{isVisible:l,onClose:N,onCreate:T,isLoading:f}),Object(u.jsx)("div",{className:"projects-wrapper",children:Object(u.jsx)(K.a,{className:"table",columns:[{title:"\u041d\u0430\u0437\u0432\u0430\u043d\u0438\u0435",dataIndex:"displayName",key:"displayName",align:"center"},{title:"\u0414\u0430\u0442\u0430 \u0441\u043e\u0437\u0434\u0430\u043d\u0438\u044f",dataIndex:"createdDateTime",key:"createdDateTime",align:"center",render:function(e){var t=new Date(e);return Object(u.jsx)("span",{children:t.toLocaleString()})}},{title:"Agile \u0434\u043e\u0441\u043a\u0430",dataIndex:"Agile",key:"agile",align:"center",render:function(e,t){return Object(u.jsx)(Q.b,{size:"middle",children:Object(u.jsx)(o.b,{to:x+"/"+t.id,children:Object(u.jsx)(ge.a,{})})},e)}},{title:"\u0414\u043e\u043a\u0443\u043c\u0435\u043d\u0442\u044b",dataIndex:"docs",key:"docs",align:"center",render:function(e,t){return Object(u.jsx)(o.b,{to:m+"/"+t.id,children:Object(u.jsx)(ye.a,{})})}}],dataSource:n,footer:function(){return Object(u.jsx)(I.a,{onClick:function(){return d(!0)},children:"\u0421\u043e\u0437\u0434\u0430\u0442\u044c \u0433\u0440\u0443\u043f\u043f\u0443"})}})})]})},Ee=n(308),Ce=n(304),Ae=n(110),Be=n(68),De=n(295),Le=(n(181),function(e){var t=e.title,n=e.content;return Object(u.jsxs)("div",{className:"site-description-item-profile-wrapper",children:[Object(u.jsxs)("p",{className:"site-description-item-profile-p-label",children:[t,":"]}),n]})}),_e=function(e){var t,n,a,r=e.userId,i=e.isVisible,o=e.onClose,l=Object(c.useState)(null),d=Object(w.a)(l,2),b=d[0],p=d[1],f=Object(s.c)(),O=f.instance,h=f.accounts;return Object(c.useEffect)((function(){O.acquireTokenSilent(Object(j.a)(Object(j.a)({},E),{},{account:h[0]})).then(function(){var e=Object(k.a)(y.a.mark((function e(t){var n;return y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,ue(t.accessToken,r);case 2:n=e.sent,console.log(n),p({id:n.id,firstName:n.givenName,lastName:n.surname,email:n.mail,businessPhone:n.businessPhones?n.businessPhones[0]:null,jobTitle:n.jobTitle,officeLocation:n.officeLocation});case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()).catch((function(e){return console.log(e)}))}),[]),Object(u.jsx)(Ce.a,{width:640,placement:"right",closable:!0,onClose:o,visible:i,children:b&&Object(u.jsxs)(u.Fragment,{children:[Object(u.jsx)("p",{className:"site-description-item-profile-p",style:{marginBottom:24},children:"\u0418\u043d\u0444\u043e\u0440\u043c\u0430\u0446\u0438\u044f \u043e \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u0435"}),Object(u.jsx)("p",{className:"site-description-item-profile-p",children:"\u041f\u0435\u0440\u0441\u043e\u043d\u0430\u043b\u044c\u043d\u044b\u0435 \u0434\u0430\u043d\u043d\u044b\u0435"}),Object(u.jsxs)(Ae.a,{children:[Object(u.jsx)(Be.a,{span:12,children:Object(u.jsx)(Le,{title:"\u0418\u043c\u044f",content:b.firstName})}),Object(u.jsx)(Be.a,{span:12,children:Object(u.jsx)(Le,{title:"\u0424\u0430\u043c\u0438\u043b\u0438\u044f",content:b.lastName})})]}),Object(u.jsxs)(Ae.a,{children:[Object(u.jsx)(Be.a,{span:12,children:Object(u.jsx)(Le,{title:"\u0414\u043e\u043b\u0436\u043d\u043e\u0441\u0442\u044c",content:null!==(t=b.jobTitle)&&void 0!==t?t:"-"})}),Object(u.jsx)(Be.a,{span:12,children:Object(u.jsx)(Le,{title:"\u041e\u0444\u0438\u0441",content:null!==(n=b.officeLocation)&&void 0!==n?n:"-"})})]}),Object(u.jsx)(De.a,{}),Object(u.jsx)("p",{className:"site-description-item-profile-p",children:"\u041a\u043e\u043d\u0442\u0430\u043a\u0442\u044b"}),Object(u.jsx)(Ae.a,{children:Object(u.jsx)(Le,{title:"Email",content:b.email})}),Object(u.jsx)(Ae.a,{children:Object(u.jsx)(Le,{title:"\u0422\u0435\u043b\u0435\u0444\u043e\u043d",content:null!==(a=b.businessPhone)&&void 0!==a?a:"-"})})]})})},Ue=function(){var e=Object(c.useState)([]),t=Object(w.a)(e,2),n=t[0],a=t[1],r=Object(c.useState)(""),i=Object(w.a)(r,2),o=i[0],l=i[1],d=Object(c.useState)(!1),b=Object(w.a)(d,2),p=b[0],f=b[1],O=Object(s.c)(),h=O.instance,m=O.accounts;Object(c.useEffect)((function(){h.acquireTokenSilent(Object(j.a)(Object(j.a)({},E),{},{account:m[0]})).then((function(e){oe(e.accessToken).then((function(e){a(e.value.map((function(e){return{id:e.id,firstName:e.givenName,lastName:e.surname,email:e.userPrincipalName}})))}))})).catch((function(e){return console.log(e)}))}),[]);return Object(u.jsxs)(se,{children:[o&&Object(u.jsx)(_e,{userId:o,isVisible:p,onClose:function(){f(!1),l("")}}),Object(u.jsx)(K.a,{className:"table",columns:[{title:"\u0418\u043c\u044f \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044f",dataIndex:"name",key:"name"},{title:"Email",dataIndex:"email",key:"email"},{title:"\u041f\u043e\u0434\u0440\u043e\u0431\u043d\u043e",dataIndex:"info",key:"info",align:"center",render:function(e,t){return Object(u.jsx)(Ee.a,{style:{color:"#1890ff"},onClick:function(){return e=t.id,l(e),void f(!0);var e}})}}],dataSource:n?n.map((function(e){return{key:e.id,id:e.id,name:"".concat(e.firstName," ").concat(e.lastName),email:e.email}})):[]})]})},Re=n(191),ze=n(83),qe=n(103),Ge=n(119),Me=n(299),Pe=n(120),Ve=T.a.Text,He=Pe.a.div(H||(H=Object(Ge.a)(["\n  margin-bottom: 8px;\n  "]))),Je=function(e){var t=e.task,n=e.index;return Object(u.jsx)(qe.b,{draggableId:t.id,index:n,children:function(e){return Object(u.jsx)(He,Object(j.a)(Object(j.a)(Object(j.a)({ref:e.innerRef},e.draggableProps),e.dragHandleProps),{},{children:Object(u.jsxs)(Me.a,{style:{minWidth:200,textAlign:"left"},size:"small",children:[Object(u.jsxs)("p",{children:[Object(u.jsxs)(Ve,{strong:!0,children:["#",t.id,": "]}),Object(u.jsx)(Ve,{children:t.title})]}),Object(u.jsxs)("p",{children:[Object(u.jsx)(Ve,{type:"secondary",children:"\u0422\u0438\u043f: "}),Object(u.jsx)(Ve,{children:t.percentComplete})]})]})}))}})},Fe=Pe.a.div(J||(J=Object(Ge.a)(["\n  padding: 8px;\n  transition: background-color 0.2s ease;\n  background-color: ","\n  flex-grow: 1;\n  min-height: 60vh;\n"])),(function(e){return e.isDraggingOver?"skyblue":"white"})),Xe=function(e){var t=e.id,n=e.tasks,c=e.title,a=Pe.a.div(F||(F=Object(Ge.a)(["\n  border: 1px solid lightgrey;\n  border-radius: 2px;\n  flex-grow: 1;\n  text-align: center;\n  margin-right: ",";\n  width: 100px;\n\n  display: flex;\n  flex-direction: column;\n"])),"column-3"!==t?"8px":"0");return Object(u.jsxs)(a,{children:[Object(u.jsx)("div",{style:{borderBottom:"1px solid lightgrey",backgroundColor:"#fff",height:"30px",display:"flex",alignItems:"center",justifyContent:"center"},children:Object(u.jsx)(T.a.Text,{children:c})}),Object(u.jsx)(qe.c,{droppableId:t,children:function(e){return Object(u.jsxs)(Fe,Object(j.a)(Object(j.a)({ref:e.innerRef,className:"column"},e.droppableProps),{},{children:[n&&n.map((function(e,t){return Object(u.jsx)(Je,{task:e,index:t},e.id)})),e.placeholder]}))}})]})},Ye=n(202),We=(n(290),n(121)),Ke=n(297),Qe=n(67),Ze=n.n(Qe),$e=function(e){var t=e.visible,n=e.setVisible,a=e.planId,r=e.groupId,i=Object(c.useState)(!1),o=Object(w.a)(i,2),l=o[0],d=o[1],b=Object(c.useState)({id:"",planId:"",percentComplete:0,assigmentBy:"",dueDateTime:"",title:"",description:""}),p=Object(w.a)(b,2),f=p[0],O=p[1],h=Object(c.useState)([]),m=Object(w.a)(h,2),x=m[0],v=m[1],g=Object(c.useState)(!1),T=Object(w.a)(g,2),I=T[0],N=T[1],S=Object(s.c)(),C=S.instance,A=S.accounts,B=function(){var e=Object(k.a)(y.a.mark((function e(t){return y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t&&(N(!0),C.acquireTokenSilent(Object(j.a)(Object(j.a)({},E),{},{account:A[0]})).then(function(){var e=Object(k.a)(y.a.mark((function e(t){var n;return y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,me(t.accessToken,r);case 2:n=e.sent,v(n.value.map((function(e){return{label:e.displayName,value:e.id}})));case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()).catch((function(e){return console.log(e)}))),N(!1);case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return Object(u.jsx)(ke.a,{title:"\u0414\u043e\u0431\u0430\u0432\u0438\u0442\u044c \u043d\u043e\u0432\u0443\u044e \u0437\u0430\u0434\u0430\u0447\u0443",visible:t,confirmLoading:l,cancelText:"\u041e\u0442\u043c\u0435\u043d\u0430",okText:"\u0414\u043e\u0431\u0430\u0432\u0438\u0442\u044c",onCancel:function(){n(!1)},onOk:function(){d(!0),C.acquireTokenSilent(Object(j.a)(Object(j.a)({},E),{},{account:A[0]})).then(function(){var e=Object(k.a)(y.a.mark((function e(t){var n,c,r;return y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n={planId:a,title:f.title},e.next=3,xe(t.accessToken,n);case 3:return c=e.sent,r={planId:a,assignments:Object(ze.a)({},f.assigmentBy,{"@odata.type":"#microsoft.graph.plannerAssignment",orderHint:" !"})},e.next=7,ve(t.accessToken,c.id,r,c["@odata.etag"]);case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()).catch((function(e){return console.log(e)})),d(!1)},children:Object(u.jsxs)(we.a,{layout:"vertical",children:[Object(u.jsx)(we.a.Item,{name:"title",label:"\u0417\u0430\u0434\u0430\u0447\u0430",rules:[{required:!0,message:"\u0412\u0432\u0435\u0434\u0438\u0442\u0435 \u043d\u0430\u0437\u0432\u0430\u043d\u0438\u0435 \u0437\u0430\u0434\u0430\u0447\u0438"}],children:Object(u.jsx)(Te.a,{value:f.title,onChange:function(e){O(Object(j.a)(Object(j.a)({},f),{},{title:e.target.value}))}})}),Object(u.jsx)(we.a.Item,{name:"description",label:"\u041e\u043f\u0438\u0441\u0430\u043d\u0438\u0435",children:Object(u.jsx)(Ie.a,{value:f.description,onChange:function(e){O(Object(j.a)(Object(j.a)({},f),{},{description:e.target.value}))}})}),Object(u.jsx)(we.a.Item,{label:"\u041d\u0430\u0437\u043d\u0430\u0447\u0438\u0442\u044c",children:Object(u.jsx)(We.a,{placeholder:"\u041d\u0430\u0437\u043d\u0430\u0447\u0438\u0442\u044c",value:f.assigmentBy,onDropdownVisibleChange:B,onChange:function(e){O(Object(j.a)(Object(j.a)({},f),{},{assigmentBy:e}))},options:x,loading:I})}),Object(u.jsx)(we.a.Item,{label:"\u0421\u0440\u043e\u043a \u0432\u044b\u043f\u043e\u043b\u043d\u0435\u043d\u0438\u044f",children:Object(u.jsx)(Ke.a,{placeholder:"\u0421\u0440\u043e\u043a",value:f.dueDateTime?Ze()(f.dueDateTime):null,format:"DD.MM.YYYY",onChange:function(e){O(Object(j.a)(Object(j.a)({},f),{},{dueDateTime:Ze()(e).toISOString()}))}})})]})})},et=function(e){var t=e.data,n=e.planId,a=e.groupId,r=Object(c.useState)(t),i=Object(w.a)(r,2),s=i[0],o=i[1],l=Object(c.useState)(!1),d=Object(w.a)(l,2),b=d[0],p=d[1];return Object(u.jsxs)("div",{children:[Object(u.jsx)("div",{className:"toolbar",children:Object(u.jsx)(I.a,{size:"large",type:"text",onClick:function(){p(!0)},icon:Object(u.jsx)(Ye.a,{}),children:"\u0414\u043e\u0431\u0430\u0432\u0438\u0442\u044c \u0437\u0430\u0434\u0430\u0447\u0443"})}),Object(u.jsx)(qe.a,{onDragEnd:function(e){var t,n=e.destination,c=e.source,a=e.draggableId;if(n&&(n.droppableId!==c.droppableId||n.index!==c.index)){var r=s.columns[c.droppableId],i=s.columns[n.droppableId];if(r!==i){var u=Array.from(r.taskIds);u.splice(c.index,1);var l=Object(j.a)(Object(j.a)({},r),{},{taskIds:u}),d=Array.from(i.taskIds);d.splice(n.index,0,a);var b=Object(j.a)(Object(j.a)({},i),{},{taskIds:d}),p=Object(j.a)(Object(j.a)({},s),{},{columns:Object(j.a)(Object(j.a)({},s.columns),{},(t={},Object(ze.a)(t,l.id,l),Object(ze.a)(t,b.id,b),t))});o(p)}else{var f=Array.from(r.taskIds);f.splice(c.index,1),f.splice(n.index,0,a);var O=Object(j.a)(Object(j.a)({},r),{},{taskIds:f}),h=Object(j.a)(Object(j.a)({},s),{},{columns:Object(j.a)(Object(j.a)({},s.columns),{},Object(ze.a)({},O.id,O))});o(h)}}},children:Object(u.jsx)("div",{style:{display:"flex"},children:s.columnOrder.map((function(e){var t=s.columns[e],n=t.taskIds.map((function(e){return s.tasks[e]}));return Object(u.jsx)(Xe,{id:t.id,tasks:n,title:t.title},t.id)}))})}),b&&Object(u.jsx)($e,{visible:b,setVisible:function(e){p(e)},planId:n,groupId:a})]})},tt={tasks:{},columns:{"column-1":{id:"column-1",title:"\u041d\u043e\u0432\u044b\u0435",taskIds:[]},"column-2":{id:"column-2",title:"\u0410\u043a\u0442\u0438\u0432\u043d\u044b\u0435",taskIds:[]},"column-3":{id:"column-3",title:"\u0412\u044b\u043f\u043e\u043b\u043d\u0435\u043d\u043d\u044b\u0435",taskIds:[]}},columnOrder:["column-1","column-2","column-3"]},nt=function(){var e=Object(c.useState)([]),t=Object(w.a)(e,2),n=t[0],a=t[1],r=Object(c.useState)(tt),i=Object(w.a)(r,2),o=i[0],l=i[1],b=Object(c.useState)(""),p=Object(w.a)(b,2),f=p[0],O=p[1],h=Object(d.h)().groupId,m=Object(s.c)(),x=m.instance,v=m.accounts;return Object(c.useEffect)((function(){x.acquireTokenSilent(Object(j.a)(Object(j.a)({},E),{},{account:v[0]})).then(function(){var e=Object(k.a)(y.a.mark((function e(t){var n,c;return y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Oe(t.accessToken,h);case 2:return n=e.sent,e.next=5,he(t.accessToken,n.value[0].id);case 5:c=e.sent,O(n.value[0].id),a(c.value.map((function(e){return{id:e.id,planId:e.planId,percentComplete:e.percentComplete,assigmentBy:Object.keys(e.assignments)?Object.keys(e.assignments):"",dueDateTime:e.dueDateTime,title:e.title,description:e.description?e.description:""}})));case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()).catch((function(e){return console.log(e)}))}),[]),Object(c.useEffect)((function(){if(n){var e,t=Object(j.a)({},tt),c=Object(Re.a)(n);try{for(c.s();!(e=c.n()).done;){var a=e.value;t.tasks[a.id]=a,0===a.percentComplete?t.columns["column-1"].taskIds.push(a.id):50===a.percentComplete?t.columns["column-2"].taskIds.push(a.id):t.columns["column-3"].taskIds.push(a.id)}}catch(r){c.e(r)}finally{c.f()}l(t)}}),[n]),Object(u.jsx)(se,{children:f&&Object(u.jsx)(et,{data:o,planId:f,groupId:h})})},ct=n(154),at=n(203),rt=n(298),it=n(309);var st=function(e){var t=e.isVisible,n=e.onClose,a=e.onUpload,r=e.isLoading,i=Object(c.useState)(null),s=Object(w.a)(i,2),o=s[0],l=s[1],d=Object(c.useState)("file"),j=Object(w.a)(d,2),b=j[0],p=j[1];return Object(c.useEffect)((function(){t||l(null)}),[t]),Object(u.jsx)(ke.a,{title:"\u0417\u0430\u0433\u0440\u0443\u0437\u0438\u0442\u044c \u0444\u0430\u0439\u043b",visible:t,onCancel:n,onOk:function(){return a(b,o)},confirmLoading:r,children:Object(u.jsxs)(rt.a.Dragger,{disabled:r,beforeUpload:function(e){p(e.name);var t=new FileReader;return t.readAsArrayBuffer(e),t.onload=function(){l(t.result)},!1},children:[Object(u.jsx)("p",{className:"ant-upload-drag-icon",children:Object(u.jsx)(it.a,{})}),Object(u.jsx)("p",{className:"ant-upload-text",children:"\u041d\u0430\u0436\u043c\u0438\u0442\u0435 \u0438\u043b\u0438 \u043f\u0435\u0440\u0435\u0442\u0430\u0449\u0438\u0442\u0435 \u0444\u0430\u0439\u043b\u044b \u0432 \u044d\u0442\u0443 \u0437\u043e\u043d\u0443"}),Object(u.jsx)("p",{className:"ant-upload-hint",children:"\u041c\u043e\u0436\u043d\u043e \u0434\u043e\u0431\u0430\u0432\u0438\u0442\u044c \u043d\u0435\u0441\u043a\u043e\u043b\u044c\u043a\u043e \u0444\u0430\u0439\u043b\u043e\u0432"})]})})},ot=function(){var e=Object(c.useState)([]),t=Object(w.a)(e,2),n=t[0],a=t[1],r=Object(c.useState)(!1),i=Object(w.a)(r,2),l=i[0],b=i[1],p=Object(c.useState)(!1),f=Object(w.a)(p,2),O=f[0],h=f[1],x=Object(d.h)().groupId,v=Object(s.c)(),g=v.instance,T=v.accounts,N=function(){var e=Object(k.a)(y.a.mark((function e(){return y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:g.acquireTokenSilent(Object(j.a)(Object(j.a)({},E),{},{account:T[0]})).then(function(){var e=Object(k.a)(y.a.mark((function e(t){return y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,je(t.accessToken,x).then((function(e){a(e.value.map((function(e){return{id:e.id,key:e.id,name:e.name,createdDate:e.fileSystemInfo.createdDateTime,createdBy:e.createdBy.user?e.createdBy.user.displayName:e.createdBy.application.displayName,lastModifiedDate:e.fileSystemInfo.lastModifiedDateTime,lastModifiedBy:e.lastModifiedBy.user?e.lastModifiedBy.user.displayName:e.createdBy.application.displayName,file:e.file,webUrl:e.webUrl}})))}));case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()).catch((function(e){return console.log(e)}));case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();Object(c.useEffect)((function(){N()}),[]);var S=function(){var e=Object(k.a)(y.a.mark((function e(t){var n,c;return y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=null,e.next=3,g.acquireTokenSilent(Object(j.a)(Object(j.a)({},E),{},{account:T[0]})).then(function(){var e=Object(k.a)(y.a.mark((function e(c){return y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,be(c.accessToken,x,t);case 2:n=e.sent;case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()).catch((function(e){return console.log(e)}));case 3:null!==n&&((c=document.createElement("a")).href=n.link.webUrl,c.setAttribute("target","_blank"),document.body.appendChild(c),c.click(),c.remove());case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),C=Object(c.useCallback)(function(){var e=Object(k.a)(y.a.mark((function e(t){return y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,g.acquireTokenSilent(Object(j.a)(Object(j.a)({},E),{},{account:T[0]})).then(function(){var e=Object(k.a)(y.a.mark((function e(n){return y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,pe(n.accessToken,x,t.id);case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()).catch((function(e){return console.log(e)}));case 2:return e.next=4,N();case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),[]),A=function(){var e=Object(k.a)(y.a.mark((function e(t,n){return y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return h(!0),e.next=3,g.acquireTokenSilent(Object(j.a)(Object(j.a)({},E),{},{account:T[0]})).then(function(){var e=Object(k.a)(y.a.mark((function e(c){var a;return y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fe(c.accessToken,x,t,n);case 2:a=e.sent,console.log(a);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()).catch((function(e){return console.log(e)}));case 3:return e.next=5,N();case 5:h(!1);case 6:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}();return Object(u.jsxs)(se,{children:[Object(u.jsx)(st,{isVisible:l,onClose:function(){b(!1)},onUpload:A,isLoading:O}),Object(u.jsx)(Q.b,{className:"space-link",children:Object(u.jsx)(o.b,{className:"link",to:m,children:"\u0412\u0435\u0440\u043d\u0443\u0442\u044c\u0441\u044f \u043a \u0433\u0440\u0443\u043f\u043f\u0430\u043c"})}),Object(u.jsx)(K.a,{className:"table",columns:[{title:"\u041d\u0430\u0437\u0432\u0430\u043d\u0438\u0435",dataIndex:"name",key:"name",align:"center"},{title:"\u0421\u043e\u0437\u0434\u0430\u043d",dataIndex:"createdBy",key:"createdBy",align:"center"},{title:"\u0414\u0430\u0442\u0430 \u0441\u043e\u0437\u0434\u0430\u043d\u0438\u044f",dataIndex:"createdDate",key:"createdDate",align:"center",render:function(e){var t=new Date(e);return Object(u.jsx)("span",{children:t.toLocaleString()})}},{title:"\u0418\u0437\u043c\u0435\u043d\u0435\u043d",dataIndex:"lastModifiedBy",key:"lastModifiedBy",align:"center"},{title:"\u0414\u0430\u0442\u0430 \u0438\u0437\u043c\u0435\u043d\u0435\u043d\u0438\u044f",dataIndex:"lastModifiedDate",key:"lastModifiedDate",align:"center",render:function(e){var t=new Date(e);return Object(u.jsx)("span",{children:t.toLocaleString()})}},{title:"\u041f\u0440\u043e\u0441\u043c\u043e\u0442\u0440",dataIndex:"webUrl",key:"webUrl",align:"center",render:function(e,t){return Object(u.jsx)(ct.a,{style:{color:"#1890ff"},onClick:function(){return S(t.id)}})}},{title:"\u0423\u0434\u0430\u043b\u0438\u0442\u044c",dataIndex:"delete",key:"delete",align:"center",render:function(e,t){return Object(u.jsx)(at.a,{style:{color:"red"},onClick:function(){return C(t)}})}}],dataSource:n,footer:function(){return Object(u.jsx)(I.a,{onClick:function(){return b(!0)},children:"\u0417\u0430\u0433\u0440\u0443\u0437\u0438\u0442\u044c \u0444\u0430\u0439\u043b"})}})]})};function ut(){return Object(u.jsxs)(d.d,{children:[Object(u.jsx)(d.b,{exact:!0,path:O,component:W}),Object(u.jsx)(v,{exact:!0,path:m,component:Se}),Object(u.jsx)(v,{exact:!0,path:h,component:Ue}),Object(u.jsx)(v,{exact:!0,path:m+"/:groupId",component:ot}),Object(u.jsx)(v,{exact:!0,path:x+"/:groupId",component:nt}),Object(u.jsx)(d.a,{to:"/"})]})}var lt=function(){var e=Object(k.a)(y.a.mark((function e(t,n,c,a){return y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!c||!c[0]||a){e.next=3;break}return e.next=3,n.acquireTokenSilent(Object(j.a)(Object(j.a)({},E),{},{account:c[0]})).then((function(e){R(e.accessToken).then((function(e){var n={id:e.id,firstName:e.givenName,lastName:e.surname,email:e.mail};t(G(n))}))})).catch((function(e){return console.log(e)}));case 3:case"end":return e.stop()}}),e)})));return function(t,n,c,a){return e.apply(this,arguments)}}(),dt=function(e){var t=e.children,n=Object(i.d)(ee),a=Object(i.d)(te),r=Object(s.c)(),o=r.instance,l=r.accounts,d=Object(i.c)();return Object(c.useEffect)((function(){lt(d,o,l,n)}),[a,d,l,l]),Object(u.jsx)(u.Fragment,{children:t})},jt=new N.g(S);var bt=function(){return Object(u.jsx)(s.a,{instance:jt,children:Object(u.jsx)(dt,{children:Object(u.jsx)(l,{children:Object(u.jsx)(ut,{})})})})},pt=(n(291),n(73)),ft=Object(pt.d)((function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:V,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case q.SET_AUTHENTICATION_ERROR:return Object(j.a)(Object(j.a)({},e),{},{authenticationError:t.error});case q.LOG_IN:return Object(j.a)(Object(j.a)({},e),{},{authenticationError:null,user:t.user,isAuthenticated:!0});case q.LOG_OUT:return Object(j.a)(Object(j.a)({},e),{},{user:V.user,authenticationError:null,isAuthenticated:!1})}return e}),window.__REDUX_DEVTOOLS_EXTENSION__&&window.__REDUX_DEVTOOLS_EXTENSION__());r.a.render(Object(u.jsx)(i.a,{store:ft,children:Object(u.jsx)(bt,{})}),document.getElementById("root"))}},[[292,1,2]]]);
//# sourceMappingURL=main.f5a2cc04.chunk.js.map